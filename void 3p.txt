Количество неудачных попыток авторизации в Nginx можно ограничить с помощью модуля `limit_req`, который позволяет ограничить количество запросов от одного IP-адреса в течение определенного времени. Для установки лимита на количество неудачных попыток необходимо использовать параметры `limit_req_zone` и `limit_req`.

Пример:

```
http {
  limit_req_zone $binary_remote_addr zone=auth_fail:10m rate=1r/m;
 
  server {
    ...
    location /login {
      limit_req zone=auth_fail burst=3 nodelay;
      ...
    }
    ...
  }
}
```

В данном примере установлено, что пользователь не может выполнить больше 1 запроса в минуту (rate=1r/m) на авторизационную страницу (/login) и в случае превышения лимита (больше 3 запросов) соединение будет закрыто без задержки (nodelay).

Обратите внимание, что в данном примере лимит устанавливается на количество запросов, а не на количество неудачных попыток авторизации. Если необходимо ограничить количество неудачных попыток авторизации, то можно использовать другой модуль `http_auth_request`, как я описывал в предыдущем ответе.

sudo nano /etc/nginx/sites-available/example.com`

2. Внутри блока server добавить следующий код:

```
limit_req_zone $binary_remote_addr zone=one:10m rate=3r/s;
```

Эта директива создает зону ограничения с именем "one" и размером в 10 мегабайт. Ограничение на запросы установлено на 3 запроса в секунду.

3. Далее, в блок location сайта, добавить следующий код:

```
location / {
    limit_req zone=one burst=5 nodelay;
    ...
}
```

Эта директива ограничивает скорость запросов в соответствии с зоной "one". Превышение ограничения ведет к задержке запроса (delay). Опция "burst=5" позволяет превысить лимит на пять запросов, прежде чем начать задержку. Опция "nodelay" отключает задержку, если источник запроса превысит лимит.